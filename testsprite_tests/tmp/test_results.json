[
  {
    "projectId": "33499ef3-8a07-4c4d-8b2b-4a14c021c19d",
    "testId": "8f556f73-d2b1-4c21-b527-6b243befa91d",
    "userId": "04b8c418-1091-70d5-59f6-a08ab0c53d79",
    "title": "TC001-health check endpoint returns ok status",
    "description": "Verify that the GET /status endpoint returns a 200 status code with a response body containing {ok: true} without requiring authentication.",
    "code": "import requests\n\nBASE_URL = \"http://localhost:5000\"\nTIMEOUT = 30\n\ndef test_health_check_endpoint_returns_ok_status():\n    try:\n        # 1. GET /status - Expected: 200 and JSON contains { \"ok\": true }\n        response = requests.get(f\"{BASE_URL}/status\", timeout=TIMEOUT)\n        assert response.status_code == 200, f\"Expected status 200, got {response.status_code}\"\n        json_data = response.json()\n        assert \"ok\" in json_data and json_data[\"ok\"] is True, f\"Expected JSON with ok:true, got {json_data}\"\n\n        # 2. GET /auth/me without any cookie - Expected: 401\n        response = requests.get(f\"{BASE_URL}/auth/me\", timeout=TIMEOUT)\n        assert response.status_code == 401, f\"Expected status 401, got {response.status_code}\"\n\n        # 3. POST /auth/e2e/login with given body - Expected: 200 { \"ok\": true } and sets httpOnly session cookie\n        login_payload = {\"id\": \"e2e_user_1\", \"email\": \"e2e@test.local\", \"name\": \"E2E User\"}\n        response = requests.post(f\"{BASE_URL}/auth/e2e/login\", json=login_payload, timeout=TIMEOUT)\n        assert response.status_code == 200, f\"Expected status 200, got {response.status_code}\"\n        json_data = response.json()\n        assert \"ok\" in json_data and json_data[\"ok\"] is True, f\"Expected JSON with ok:true, got {json_data}\"\n        cookies = response.cookies\n        session_cookie = None\n        for cookie in cookies:\n            if cookie._rest.get('HttpOnly') is not None or cookie.name.lower().find(\"session\") >= 0:\n                session_cookie = cookie\n                break\n        assert session_cookie is not None, \"Expected an HttpOnly session cookie to be set\"\n\n        # 4. GET /auth/me using the cookie from previous step - Expected: 200 and JSON contains user.id and user.email\n        jar = requests.cookies.RequestsCookieJar()\n        jar.set(session_cookie.name, session_cookie.value, domain=session_cookie.domain, path=session_cookie.path, secure=session_cookie.secure, rest={'HttpOnly': True})\n        response = requests.get(f\"{BASE_URL}/auth/me\", cookies=jar, timeout=TIMEOUT)\n        assert response.status_code == 200, f\"Expected status 200, got {response.status_code}\"\n        user_data = response.json().get(\"user\", {})\n        assert user_data.get(\"id\") == \"e2e_user_1\", f\"Expected user.id e2e_user_1, got {user_data.get('id')}\"\n        assert user_data.get(\"email\") == \"e2e@test.local\", f\"Expected user.email e2e@test.local, got {user_data.get('email')}\"\n\n    except requests.RequestException as e:\n        assert False, f\"Request failed: {e}\"\n\ntest_health_check_endpoint_returns_ok_status()",
    "testStatus": "PASSED",
    "testError": "",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2026-02-21T04:30:12.617Z",
    "modified": "2026-02-21T04:30:32.099Z"
  },
  {
    "projectId": "33499ef3-8a07-4c4d-8b2b-4a14c021c19d",
    "testId": "038f6ca1-2048-488b-a894-be05d82a7498",
    "userId": "04b8c418-1091-70d5-59f6-a08ab0c53d79",
    "title": "TC002-unauthenticated get user info returns unauthorized",
    "description": "Verify that the GET /auth/me endpoint returns a 401 status code when accessed without authentication.",
    "code": "import requests\n\nbase_url = \"http://localhost:5000\"\ntimeout = 30\n\ndef test_unauthenticated_get_user_info_returns_unauthorized():\n    # 1. GET /status - Expected: 200 and JSON contains { \"ok\": true }\n    status_resp = requests.get(f\"{base_url}/status\", timeout=timeout)\n    assert status_resp.status_code == 200, f\"Expected 200 but got {status_resp.status_code}\"\n    status_json = status_resp.json()\n    assert status_json.get(\"ok\") is True, f\"Expected {{'ok': True}} but got {status_json}\"\n\n    # 2. GET /auth/me without any cookie - Expected: 401\n    auth_me_resp = requests.get(f\"{base_url}/auth/me\", timeout=timeout)\n    assert auth_me_resp.status_code == 401, f\"Expected 401 but got {auth_me_resp.status_code}\"\n\n    # 3. POST /auth/e2e/login with body {\"id\": \"e2e_user_1\", \"email\": \"e2e@test.local\", \"name\": \"E2E User\"} - Expected: 200 { \"ok\": true } and sets httpOnly session cookie\n    login_payload = {\"id\": \"e2e_user_1\", \"email\": \"e2e@test.local\", \"name\": \"E2E User\"}\n    login_resp = requests.post(f\"{base_url}/auth/e2e/login\", json=login_payload, timeout=timeout)\n    assert login_resp.status_code == 200, f\"Expected 200 but got {login_resp.status_code}\"\n    login_json = login_resp.json()\n    assert login_json.get(\"ok\") is True, f\"Expected {{'ok': True}} but got {login_json}\"\n    # Check cookie set with httpOnly flag - requests does not expose httpOnly flag but cookie set presence is validated\n    cookies = login_resp.cookies\n    assert cookies, \"Expected session cookie to be set but found none.\"\n\n    # 4. GET /auth/me using the cookie from previous step - Expected: 200 and JSON contains user.id and user.email\n    session_cookies = login_resp.cookies.get_dict()\n    auth_me_auth = requests.get(f\"{base_url}/auth/me\", cookies=session_cookies, timeout=timeout)\n    assert auth_me_auth.status_code == 200, f\"Expected 200 but got {auth_me_auth.status_code}\"\n    auth_me_json = auth_me_auth.json()\n    user = auth_me_json.get(\"user\", {})\n    assert user.get(\"id\") == \"e2e_user_1\", f\"Expected user id 'e2e_user_1' but got {user.get('id')}\"\n    assert user.get(\"email\") == \"e2e@test.local\", f\"Expected user email 'e2e@test.local' but got {user.get('email')}\"\n\ntest_unauthenticated_get_user_info_returns_unauthorized()",
    "testStatus": "PASSED",
    "testError": "",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2026-02-21T04:30:12.624Z",
    "modified": "2026-02-21T04:30:40.773Z"
  },
  {
    "projectId": "33499ef3-8a07-4c4d-8b2b-4a14c021c19d",
    "testId": "3b696ba8-747a-4224-8af5-ddac57aef130",
    "userId": "04b8c418-1091-70d5-59f6-a08ab0c53d79",
    "title": "TC003-e2e login sets cookie and returns ok",
    "description": "Verify that the POST /auth/e2e/login endpoint accepts the user credentials in the request body, returns a 200 status code with {ok: true} in the response body, and sets an authentication cookie.",
    "code": "import requests\n\nBASE_URL = \"http://localhost:5000\"\nTIMEOUT = 30\n\ndef test_tc003_e2e_login_sets_cookie_and_returns_ok():\n    login_url = f\"{BASE_URL}/auth/e2e/login\"\n    me_url = f\"{BASE_URL}/auth/me\"\n    payload = {\n        \"id\": \"e2e_user_1\",\n        \"email\": \"e2e@test.local\",\n        \"name\": \"E2E User\"\n    }\n    try:\n        # Step 1: POST /auth/e2e/login\n        response = requests.post(login_url, json=payload, timeout=TIMEOUT)\n        assert response.status_code == 200, f\"Expected 200, got {response.status_code}\"\n        resp_json = response.json()\n        assert resp_json.get(\"ok\") is True, f\"Expected 'ok': true, got {resp_json}\"\n        # Check that a HttpOnly session cookie is set\n        cookies = response.cookies\n        assert cookies, \"No cookies set in response\"\n        # Check HttpOnly attribute in cookies\n        # requests library does not expose HttpOnly flag, so check Set-Cookie header manually\n        set_cookie_headers = response.headers.getall(\"Set-Cookie\") if hasattr(response.headers, \"getall\") else response.headers.get(\"Set-Cookie\")\n        if set_cookie_headers is None:\n            raise AssertionError(\"No Set-Cookie header present in response\")\n        if isinstance(set_cookie_headers, str):\n            set_cookie_headers = [set_cookie_headers]\n        http_only_found = any(\"httponly\" in cookie.lower() for cookie in set_cookie_headers)\n        assert http_only_found, \"No HttpOnly flag found in Set-Cookie headers\"\n        \n        # Step 2: GET /auth/me using cookie from login\n        session = requests.Session()\n        # copy cookies from login response to session\n        for cookie in cookies:\n            session.cookies.set(cookie.name, cookie.value, domain=cookie.domain, path=cookie.path)\n\n        auth_me_resp = session.get(me_url, timeout=TIMEOUT)\n        assert auth_me_resp.status_code == 200, f\"Expected 200, got {auth_me_resp.status_code}\"\n        auth_me_json = auth_me_resp.json()\n        user = auth_me_json.get(\"user\")\n        assert user is not None, f\"No 'user' in response: {auth_me_json}\"\n        assert user.get(\"id\") == payload[\"id\"], f\"Expected user.id {payload['id']}, got {user.get('id')}\"\n        assert user.get(\"email\") == payload[\"email\"], f\"Expected user.email {payload['email']}, got {user.get('email')}\"\n    except requests.RequestException as e:\n        raise AssertionError(f\"HTTP request failed: {e}\")\n\ntest_tc003_e2e_login_sets_cookie_and_returns_ok()",
    "testStatus": "PASSED",
    "testError": "",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2026-02-21T04:30:12.629Z",
    "modified": "2026-02-21T04:30:34.982Z"
  },
  {
    "projectId": "33499ef3-8a07-4c4d-8b2b-4a14c021c19d",
    "testId": "ba6ddfb2-d54f-4f81-be7c-288e3fdae39a",
    "userId": "04b8c418-1091-70d5-59f6-a08ab0c53d79",
    "title": "TC004-authenticated get user info returns user details",
    "description": "Verify that the GET /auth/me endpoint returns a 200 status code with the authenticated user's id and email in the response body when accessed with valid authentication.",
    "code": "import requests\n\nBASE_URL = \"http://localhost:5000\"\nTIMEOUT = 30\n\ndef test_authenticated_get_user_info_returns_user_details():\n    # Step 1: GET /status - Expected 200 and JSON { \"ok\": true }\n    resp_status = requests.get(f\"{BASE_URL}/status\", timeout=TIMEOUT)\n    assert resp_status.status_code == 200, f\"/status returned {resp_status.status_code}, expected 200\"\n    json_status = resp_status.json()\n    assert json_status.get(\"ok\") is True, f\"/status response body missing or incorrect: {json_status}\"\n\n    # Step 2: GET /auth/me without cookie - Expected 401\n    resp_no_auth = requests.get(f\"{BASE_URL}/auth/me\", timeout=TIMEOUT)\n    assert resp_no_auth.status_code == 401, f\"/auth/me without auth returned {resp_no_auth.status_code}, expected 401\"\n\n    # Step 3: POST /auth/e2e/login with user body - Expected 200 { \"ok\": true } and httpOnly session cookie\n    login_payload = {\"id\": \"e2e_user_1\", \"email\": \"e2e@test.local\", \"name\": \"E2E User\"}\n    resp_login = requests.post(f\"{BASE_URL}/auth/e2e/login\", json=login_payload, timeout=TIMEOUT)\n    assert resp_login.status_code == 200, f\"/auth/e2e/login returned {resp_login.status_code}, expected 200\"\n    json_login = resp_login.json()\n    assert json_login.get(\"ok\") is True, f\"/auth/e2e/login response body missing or incorrect: {json_login}\"\n    cookies = resp_login.cookies\n    # Check if at least one cookie named 'session' or similar is set (httpOnly cannot be checked via requests)\n    assert len(cookies) > 0, \"No cookies set by /auth/e2e/login\"\n\n    # Step 4: GET /auth/me with cookie from login - Expected 200 and JSON contains user.id and user.email\n    resp_auth = requests.get(f\"{BASE_URL}/auth/me\", cookies=cookies, timeout=TIMEOUT)\n    assert resp_auth.status_code == 200, f\"/auth/me with auth returned {resp_auth.status_code}, expected 200\"\n    json_auth = resp_auth.json()\n    user = json_auth.get(\"user\")\n    assert user is not None, f\"/auth/me response missing 'user': {json_auth}\"\n    assert user.get(\"id\") == \"e2e_user_1\", f\"User id mismatch: expected 'e2e_user_1', got '{user.get('id')}'\"\n    assert user.get(\"email\") == \"e2e@test.local\", f\"User email mismatch: expected 'e2e@test.local', got '{user.get('email')}'\"\n\ntest_authenticated_get_user_info_returns_user_details()",
    "testStatus": "PASSED",
    "testError": "",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2026-02-21T04:30:12.635Z",
    "modified": "2026-02-21T04:30:46.868Z"
  }
]
